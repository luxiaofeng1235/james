# å¤šæºå°è¯´é‡‡é›†å™¨ç³»ç»Ÿ - ä½¿ç”¨æŒ‡å—

## ğŸ“– é¡¹ç›®æ¦‚è¿°

å¤šæºå°è¯´é‡‡é›†å™¨ç³»ç»Ÿæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¯æ‰©å±•çš„å°è¯´å†…å®¹é‡‡é›†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šä¸ªå°è¯´ç½‘ç«™çš„å¹¶å‘é‡‡é›†ï¼Œå…·å¤‡æ–­ç‚¹ç»­ä¼ ã€ä»»åŠ¡ç®¡ç†ã€è¿›åº¦è·Ÿè¸ªç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸŒ å¤šæºæ”¯æŒ**: æ”¯æŒæ³¡ä¹¦å§ã€ç¬”è¶£é˜ã€èµ·ç‚¹ä¸­æ–‡ç½‘ã€çºµæ¨ªä¸­æ–‡ç½‘ç­‰å¤šä¸ªé‡‡é›†æº
- **âš¡ å¹¶å‘å¤„ç†**: å¤šè¿›ç¨‹å¹¶å‘é‡‡é›†ï¼Œæ€§èƒ½æå‡5-10å€
- **ğŸ”„ æ–­ç‚¹ç»­ä¼ **: ç½‘ç»œä¸­æ–­è‡ªåŠ¨æ¢å¤ï¼Œæ”¯æŒä»»åŠ¡æš‚åœå’Œæ¢å¤
- **ğŸ“Š ä»»åŠ¡ç®¡ç†**: å®Œæ•´çš„ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿï¼Œæ”¯æŒæ‰¹é‡å¤„ç†
- **ğŸ“ˆ è¿›åº¦è·Ÿè¸ª**: å®æ—¶ç›‘æ§é‡‡é›†è¿›åº¦å’ŒçŠ¶æ€
- **ğŸ“ ç»“æ„åŒ–æ—¥å¿—**: å¤šçº§åˆ«æ—¥å¿—ç³»ç»Ÿï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§
- **ğŸ› ï¸ CLIå·¥å…·**: å‘½ä»¤è¡Œç®¡ç†ç•Œé¢ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²
- **ğŸ”§ é…ç½®é©±åŠ¨**: çµæ´»çš„é…ç½®æ–‡ä»¶ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 

---

## ğŸ”„ ç‰ˆæœ¬å¯¹æ¯”

### v1.0 (åŸå§‹ç‰ˆæœ¬) vs v2.0 (ä¼˜åŒ–ç‰ˆæœ¬)

| åŠŸèƒ½ç‰¹æ€§ | v1.0 åŸå§‹ç‰ˆæœ¬ | v2.0 ä¼˜åŒ–ç‰ˆæœ¬ | æ”¹è¿›è¯´æ˜ |
|---------|---------------|---------------|----------|
| **æ¶æ„è®¾è®¡** | å•æ–‡ä»¶è„šæœ¬ | æ¨¡å—åŒ–æ¶æ„ | æ›´å¥½çš„ä»£ç ç»„ç»‡å’Œç»´æŠ¤æ€§ |
| **é‡‡é›†æº** | ä¸»è¦æ”¯æŒpaoshu8 | æ”¯æŒ4+ä¸ªé‡‡é›†æº | å¯æ‰©å±•çš„æ’ä»¶åŒ–è®¾è®¡ |
| **å¹¶å‘å¤„ç†** | å•çº¿ç¨‹é¡ºåºå¤„ç† | å¤šè¿›ç¨‹å¹¶å‘ | 5-10å€æ€§èƒ½æå‡ |
| **æ–­ç‚¹ç»­ä¼ ** | âŒ ä¸æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ | ç½‘ç»œä¸­æ–­ä¸å½±å“è¿›åº¦ |
| **ä»»åŠ¡ç®¡ç†** | ç®€å•æ‰§è¡Œ | ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿ | æ”¯æŒæ‰¹é‡å’Œåˆ†å¸ƒå¼å¤„ç† |
| **è¿›åº¦è·Ÿè¸ª** | âŒ æ—  | âœ… å®æ—¶è·Ÿè¸ª | å¯è§†åŒ–è¿›åº¦ç›‘æ§ |
| **é”™è¯¯å¤„ç†** | åŸºç¡€å¤„ç† | æ™ºèƒ½é‡è¯•æœºåˆ¶ | è‡ªåŠ¨æ¢å¤å’Œé”™è¯¯åˆ†ç±» |
| **æ—¥å¿—ç³»ç»Ÿ** | echoè¾“å‡º | ç»“æ„åŒ–æ—¥å¿— | å¤šçº§åˆ«ã€å¯æœç´¢æ—¥å¿— |
| **é…ç½®ç®¡ç†** | ç¡¬ç¼–ç  | é…ç½®æ–‡ä»¶é©±åŠ¨ | çµæ´»çš„å‚æ•°è°ƒæ•´ |
| **å‘½ä»¤è¡Œå·¥å…·** | âŒ æ—  | âœ… å®Œæ•´CLI | ä¾¿äºè‡ªåŠ¨åŒ–å’Œè¿ç»´ |
| **ç›‘æ§èƒ½åŠ›** | âŒ æ—  | âœ… å®Œæ•´ç›‘æ§ | æ€§èƒ½æŒ‡æ ‡å’ŒçŠ¶æ€ç›‘æ§ |

### æ–‡ä»¶ç»“æ„å¯¹æ¯”

#### v1.0 æ–‡ä»¶ç»“æ„
```
paoshu8/
â””â”€â”€ gather_info_local.php    # å•ä¸€è„šæœ¬æ–‡ä»¶ (çº¦300è¡Œ)
```

#### v2.0 æ–‡ä»¶ç»“æ„
```
paoshu8/
â”œâ”€â”€ multi_source_collector.php           # ä¸»æ§åˆ¶å™¨ (çº¦400è¡Œ)
â”œâ”€â”€ collectors/                           # é‡‡é›†å™¨æ¨¡å—
â”‚   â”œâ”€â”€ base_collector.php              # åŸºç¡€é‡‡é›†å™¨ (çº¦300è¡Œ)
â”‚   â”œâ”€â”€ paoshu8_collector.php           # æ³¡ä¹¦å§é‡‡é›†å™¨ (çº¦150è¡Œ)
â”‚   â””â”€â”€ biquge_collector.php            # ç¬”è¶£é˜é‡‡é›†å™¨ (çº¦200è¡Œ)
â”œâ”€â”€ utils/                               # å·¥å…·ç±»æ¨¡å—
â”‚   â”œâ”€â”€ task_manager.php                # ä»»åŠ¡ç®¡ç†å™¨ (çº¦400è¡Œ)
â”‚   â”œâ”€â”€ progress_tracker.php            # è¿›åº¦è·Ÿè¸ªå™¨ (çº¦300è¡Œ)
â”‚   â””â”€â”€ collector_logger.php            # æ—¥å¿—è®°å½•å™¨ (çº¦350è¡Œ)
â”œâ”€â”€ config/                              # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ collector_config.php            # ä¸»é…ç½®æ–‡ä»¶ (çº¦200è¡Œ)
â”œâ”€â”€ cli/                                 # å‘½ä»¤è¡Œå·¥å…·
â”‚   â””â”€â”€ collector_cli.php               # CLIç®¡ç†å·¥å…· (çº¦500è¡Œ)
â”œâ”€â”€ logs/                                # æ—¥å¿—ç›®å½• (è‡ªåŠ¨åˆ›å»º)
â”œâ”€â”€ USAGE_GUIDE.md                       # ä½¿ç”¨æ–‡æ¡£
â””â”€â”€ examples/                            # ä½¿ç”¨ç¤ºä¾‹
    â”œâ”€â”€ basic_usage.php
    â”œâ”€â”€ advanced_usage.php
    â””â”€â”€ custom_collector.php
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **PHP**: >= 7.4
- **æ‰©å±•**: swoole, redis, curl, json, mbstring
- **å†…å­˜**: >= 8GB æ¨è
- **å­˜å‚¨**: >= 100GB å¯ç”¨ç©ºé—´

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-repo/novel-collector.git
cd novel-collector
```

2. **å®‰è£…ä¾èµ–**
```bash
composer install
```

3. **é…ç½®ç¯å¢ƒ**
```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp paoshu8/config/collector_config.php.example paoshu8/config/collector_config.php

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim paoshu8/config/collector_config.php
```

4. **åˆ›å»ºå¿…è¦ç›®å½•**
```bash
mkdir -p paoshu8/logs
mkdir -p /data/html
mkdir -p /data/images
mkdir -p /data/json
chmod 755 paoshu8/cli/collector_cli.php
```

5. **æµ‹è¯•å®‰è£…**
```bash
php paoshu8/cli/collector_cli.php sources
```

---

## ğŸ“‹ ä½¿ç”¨æŒ‡å—

### åŸºç¡€ä½¿ç”¨

#### 1. å¯åŠ¨é‡‡é›†ä»»åŠ¡
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨æ‰€æœ‰å¯ç”¨çš„é‡‡é›†æº
php paoshu8/cli/collector_cli.php start

# æŒ‡å®šé‡‡é›†æº
php paoshu8/cli/collector_cli.php start --sources paoshu8,biquge

# è‡ªå®šä¹‰å‚æ•°
php paoshu8/cli/collector_cli.php start \
  --sources paoshu8,biquge \
  --workers 5 \
  --batch-size 50 \
  --log-level INFO
```

#### 2. æŸ¥çœ‹çŠ¶æ€
```bash
# æŸ¥çœ‹æ•´ä½“çŠ¶æ€
php paoshu8/cli/collector_cli.php status

# æŸ¥çœ‹ç‰¹å®šä»»åŠ¡çŠ¶æ€
php paoshu8/cli/collector_cli.php status task_12345
```

#### 3. ç®¡ç†ä»»åŠ¡
```bash
# æš‚åœä»»åŠ¡
php paoshu8/cli/collector_cli.php stop task_12345

# æ¢å¤ä»»åŠ¡
php paoshu8/cli/collector_cli.php resume task_12345

# é‡å¯å¤±è´¥çš„ä»»åŠ¡
php paoshu8/cli/collector_cli.php restart task_12345
```

### é«˜çº§ä½¿ç”¨

#### 1. è‡ªå®šä¹‰é…ç½®
```php
// paoshu8/config/collector_config.php
return [
    'global' => [
        'max_workers' => 10,        // æœ€å¤§å·¥ä½œè¿›ç¨‹æ•°
        'batch_size' => 100,        // æ‰¹å¤„ç†å¤§å°
        'request_timeout' => 30,    // è¯·æ±‚è¶…æ—¶
    ],
    'sources' => [
        'paoshu8' => [
            'enabled' => true,
            'concurrent_limit' => 5,
            'delay' => 1000,        // è¯·æ±‚é—´éš”(æ¯«ç§’)
        ],
    ],
];
```

#### 2. ç¼–ç¨‹æ–¹å¼ä½¿ç”¨
```php
<?php
require_once 'paoshu8/multi_source_collector.php';

$collector = new MultiSourceCollector();

// å¯åŠ¨é‡‡é›†
$collector->startCollection(['paoshu8', 'biquge'], [
    'batch_size' => 50,
    'max_workers' => 5,
    'resume_from_break' => true,
]);

// è·å–ç»Ÿè®¡ä¿¡æ¯
$stats = $collector->getCollectionStats($taskId);
print_r($stats);
?>
```

#### 3. è‡ªå®šä¹‰é‡‡é›†å™¨
```php
<?php
require_once 'paoshu8/collectors/base_collector.php';

class CustomCollector extends BaseCollector {
    public function collectNovel($novel, $progress = null) {
        // å®ç°è‡ªå®šä¹‰é‡‡é›†é€»è¾‘
        return [
            'success' => true,
            'chapters_count' => 100
        ];
    }
}
?>
```

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å•å…ƒæµ‹è¯•

#### 1. æµ‹è¯•é‡‡é›†å™¨åŠŸèƒ½
```bash
# åˆ›å»ºæµ‹è¯•è„šæœ¬
cat > test_collector.php << 'EOF'
<?php
require_once 'paoshu8/collectors/paoshu8_collector.php';
require_once 'library/init.inc.php';

// æµ‹è¯•å•æœ¬å°è¯´é‡‡é›†
$collector = new Paoshu8Collector($config, $mysql_obj, $redis_data, $logger);

$testNovel = [
    'store_id' => 12345,
    'story_id' => 'test_123',
    'title' => 'æµ‹è¯•å°è¯´',
    'author' => 'æµ‹è¯•ä½œè€…',
    'story_link' => 'https://www.paoshu8.com/book/test_123/',
    'is_async' => 0
];

$result = $collector->collectNovel($testNovel);
var_dump($result);
EOF

php test_collector.php
```

#### 2. æµ‹è¯•ä»»åŠ¡ç®¡ç†å™¨
```bash
cat > test_task_manager.php << 'EOF'
<?php
require_once 'paoshu8/utils/task_manager.php';
require_once 'library/init.inc.php';

$taskManager = new TaskManager($redis_data);

// åˆ›å»ºæµ‹è¯•ä»»åŠ¡
$mainTaskId = $taskManager->createMainTask(['paoshu8'], ['batch_size' => 10]);
echo "åˆ›å»ºä¸»ä»»åŠ¡: {$mainTaskId}\n";

// åˆ›å»ºå­ä»»åŠ¡
$subTaskId = $taskManager->createSubTask($mainTaskId, [
    'source' => 'paoshu8',
    'novels' => [['store_id' => 1, 'title' => 'test']]
]);
echo "åˆ›å»ºå­ä»»åŠ¡: {$subTaskId}\n";

// è·å–ä»»åŠ¡
$task = $taskManager->getNextTask($mainTaskId);
var_dump($task);
EOF

php test_task_manager.php
```

### é›†æˆæµ‹è¯•

#### 1. å°è§„æ¨¡æµ‹è¯•
```bash
# æµ‹è¯•å•ä¸ªé‡‡é›†æºï¼Œå°‘é‡æ•°æ®
php paoshu8/cli/collector_cli.php start \
  --sources paoshu8 \
  --workers 1 \
  --batch-size 5 \
  --log-level DEBUG
```

#### 2. æ€§èƒ½æµ‹è¯•
```bash
# æµ‹è¯•å¤šæºå¹¶å‘æ€§èƒ½
php paoshu8/cli/collector_cli.php start \
  --sources paoshu8,biquge \
  --workers 10 \
  --batch-size 100 \
  --log-level INFO

# ç›‘æ§æ€§èƒ½æŒ‡æ ‡
tail -f paoshu8/logs/collector_$(date +%Y-%m-%d).log | grep "Performance"
```

#### 3. æ–­ç‚¹ç»­ä¼ æµ‹è¯•
```bash
# å¯åŠ¨é‡‡é›†ä»»åŠ¡
php paoshu8/cli/collector_cli.php start --sources paoshu8 &
TASK_PID=$!

# ç­‰å¾…ä¸€æ®µæ—¶é—´åä¸­æ–­
sleep 30
kill $TASK_PID

# æ¢å¤ä»»åŠ¡
php paoshu8/cli/collector_cli.php resume task_id
```

### å‹åŠ›æµ‹è¯•

#### 1. å¹¶å‘æµ‹è¯•è„šæœ¬
```bash
cat > stress_test.sh << 'EOF'
#!/bin/bash

echo "å¼€å§‹å‹åŠ›æµ‹è¯•..."

# å¯åŠ¨å¤šä¸ªé‡‡é›†è¿›ç¨‹
for i in {1..5}; do
    php paoshu8/cli/collector_cli.php start \
      --sources paoshu8 \
      --workers 2 \
      --batch-size 20 &
    echo "å¯åŠ¨è¿›ç¨‹ $i"
done

# ç›‘æ§ç³»ç»Ÿèµ„æº
echo "ç›‘æ§ç³»ç»Ÿèµ„æº..."
while true; do
    echo "$(date): CPU: $(top -bn1 | grep "Cpu(s)" | awk '{print $2}'), Memory: $(free -m | awk 'NR==2{printf "%.1f%%", $3*100/$2}')"
    sleep 10
done
EOF

chmod +x stress_test.sh
./stress_test.sh
```

---

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### æ—¥å¿—ç›‘æ§

#### 1. å®æ—¶æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f paoshu8/logs/collector_$(date +%Y-%m-%d).log

# è¿‡æ»¤é”™è¯¯æ—¥å¿—
tail -f paoshu8/logs/collector_$(date +%Y-%m-%d).log | grep ERROR

# æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡
tail -f paoshu8/logs/collector_$(date +%Y-%m-%d).log | grep "Performance"
```

#### 2. æ—¥å¿—åˆ†æè„šæœ¬
```bash
cat > analyze_logs.sh << 'EOF'
#!/bin/bash

LOG_FILE="paoshu8/logs/collector_$(date +%Y-%m-%d).log"

echo "=== æ—¥å¿—åˆ†ææŠ¥å‘Š ==="
echo "æ—¥å¿—æ–‡ä»¶: $LOG_FILE"
echo "ç”Ÿæˆæ—¶é—´: $(date)"
echo

echo "=== é”™è¯¯ç»Ÿè®¡ ==="
grep -c "ERROR" $LOG_FILE
echo

echo "=== æœ€è¿‘10ä¸ªé”™è¯¯ ==="
grep "ERROR" $LOG_FILE | tail -10
echo

echo "=== æ€§èƒ½ç»Ÿè®¡ ==="
grep "Performance" $LOG_FILE | tail -5
echo

echo "=== é‡‡é›†ç»Ÿè®¡ ==="
grep "é‡‡é›†å®Œæˆ" $LOG_FILE | wc -l
EOF

chmod +x analyze_logs.sh
./analyze_logs.sh
```

### ç³»ç»Ÿç»´æŠ¤

#### 1. æ¸…ç†è„šæœ¬
```bash
# æ¸…ç†æ—§æ—¥å¿—
php paoshu8/cli/collector_cli.php cleanup logs

# æ¸…ç†è¿‡æœŸè¿›åº¦æ•°æ®
php paoshu8/cli/collector_cli.php cleanup progress

# æ¸…ç†å·²å®Œæˆä»»åŠ¡
php paoshu8/cli/collector_cli.php cleanup tasks

# å…¨éƒ¨æ¸…ç†
php paoshu8/cli/collector_cli.php cleanup all
```

#### 2. å¥åº·æ£€æŸ¥è„šæœ¬
```bash
cat > health_check.sh << 'EOF'
#!/bin/bash

echo "=== ç³»ç»Ÿå¥åº·æ£€æŸ¥ ==="

# æ£€æŸ¥PHPè¿›ç¨‹
echo "PHPè¿›ç¨‹æ•°: $(ps aux | grep -c 'php.*collector')"

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
echo "å†…å­˜ä½¿ç”¨: $(free -m | awk 'NR==2{printf "%.1f%%", $3*100/$2}')"

# æ£€æŸ¥ç£ç›˜ç©ºé—´
echo "ç£ç›˜ä½¿ç”¨: $(df -h / | awk 'NR==2{print $5}')"

# æ£€æŸ¥Redisè¿æ¥
redis-cli ping > /dev/null && echo "Redis: æ­£å¸¸" || echo "Redis: å¼‚å¸¸"

# æ£€æŸ¥MySQLè¿æ¥
mysql -e "SELECT 1" > /dev/null 2>&1 && echo "MySQL: æ­£å¸¸" || echo "MySQL: å¼‚å¸¸"

# æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
LOG_SIZE=$(du -sh paoshu8/logs/ | cut -f1)
echo "æ—¥å¿—å¤§å°: $LOG_SIZE"
EOF

chmod +x health_check.sh
./health_check.sh
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å†…å­˜ä¸è¶³
```bash
# ç—‡çŠ¶ï¼šPHP Fatal error: Allowed memory size exhausted
# è§£å†³ï¼šè°ƒæ•´å†…å­˜é™åˆ¶
ini_set("memory_limit", "16000M");

# æˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­è°ƒæ•´
'performance' => [
    'memory_limit' => '16000M',
]
```

#### 2. è¿æ¥è¶…æ—¶
```bash
# ç—‡çŠ¶ï¼šConnection timeout
# è§£å†³ï¼šè°ƒæ•´è¶…æ—¶è®¾ç½®
'global' => [
    'request_timeout' => 60,  // å¢åŠ è¶…æ—¶æ—¶é—´
]

# æˆ–ä½¿ç”¨ä»£ç†
'sources' => [
    'paoshu8' => [
        'proxy' => [
            'enabled' => true,
            'host' => 'proxy.example.com',
            'port' => 8080,
        ],
    ],
]
```

#### 3. æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
mysql -u username -p -e "SELECT 1"

# æ£€æŸ¥è¿æ¥æ± è®¾ç½®
'database' => [
    'max_connections' => 100,
    'connection_timeout' => 30,
]
```

#### 4. Redisè¿æ¥é—®é¢˜
```bash
# æ£€æŸ¥RedisæœåŠ¡
redis-cli ping

# æ£€æŸ¥Redisé…ç½®
redis-cli config get maxmemory
```

### è°ƒè¯•æŠ€å·§

#### 1. å¯ç”¨è°ƒè¯•æ¨¡å¼
```bash
php paoshu8/cli/collector_cli.php start \
  --sources paoshu8 \
  --workers 1 \
  --batch-size 1 \
  --log-level DEBUG
```

#### 2. å•æ­¥è°ƒè¯•
```php
// åœ¨ä»£ç ä¸­æ·»åŠ è°ƒè¯•ä¿¡æ¯
$this->logger->debug("è°ƒè¯•ä¿¡æ¯", [
    'variable' => $value,
    'step' => 'processing'
]);
```

#### 3. æ€§èƒ½åˆ†æ
```php
// æ·»åŠ æ€§èƒ½ç›‘æ§
$startTime = microtime(true);
// ... æ‰§è¡Œä»£ç  ...
$duration = microtime(true) - $startTime;
$this->logger->logPerformance('operation_name', $duration);
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### é…ç½®ä¼˜åŒ–

#### 1. å¹¶å‘è®¾ç½®
```php
// æ ¹æ®æœåŠ¡å™¨æ€§èƒ½è°ƒæ•´
'global' => [
    'max_workers' => min(10, cpu_count() * 2),  // CPUæ ¸å¿ƒæ•°çš„2å€
    'batch_size' => 50,                         // æ ¹æ®å†…å­˜è°ƒæ•´
]
```

#### 2. ç¼“å­˜ä¼˜åŒ–
```php
'cache' => [
    'html_cache_enabled' => true,
    'html_cache_ttl' => 86400,      // 24å°æ—¶ç¼“å­˜
    'redis_key_prefix' => 'collector:',
]
```

#### 3. æ•°æ®åº“ä¼˜åŒ–
```sql
-- æ·»åŠ ç´¢å¼•
CREATE INDEX idx_store_id ON ims_novel_info(store_id);
CREATE INDEX idx_is_async ON ims_novel_info(is_async);
CREATE INDEX idx_source ON ims_novel_info(source);
```

### ç³»ç»Ÿä¼˜åŒ–

#### 1. æ“ä½œç³»ç»Ÿä¼˜åŒ–
```bash
# å¢åŠ æ–‡ä»¶æè¿°ç¬¦é™åˆ¶
echo "* soft nofile 65536" >> /etc/security/limits.conf
echo "* hard nofile 65536" >> /etc/security/limits.conf

# ä¼˜åŒ–ç½‘ç»œå‚æ•°
echo "net.core.somaxconn = 65536" >> /etc/sysctl.conf
sysctl -p
```

#### 2. PHPä¼˜åŒ–
```ini
; php.ini ä¼˜åŒ–
memory_limit = 16G
max_execution_time = 0
opcache.enable = 1
opcache.memory_consumption = 512
```

---

*æœ€åæ›´æ–°: 2024å¹´1æœˆ*